# Implementation of Yolo v3

You will find here a test application of Yolo v3 deep learning method to an images detection challenge.


## Data source

I used data made available by "Radiological Society of North America" on Kaggle. The challenge name is ["RSNA Pneumonia Detection Challenge"](https://www.kaggle.com/c/rsna-pneumonia-detection-challenge).

The second version of data is organised as :
* A train folder with about 26 684 images,
* A test folder with about 3 000 images,
* A csv file named "stage_2_train_labels.csv" with the bounding boxes of all train images,
* A csv file named "sample_submission_v2.csv" to show the shape of the output expected.


## Global organisation of the repository

The folder **data** gather few files automaticaly generated by my algorithms.

The file ```pneumonia_functions.py``` is mainly dedicated to prepare the algorith to learn a new object. It offers the possibility to:
* create the structure of the project : ```def_structure``` and download automaticaly a pre trained weight given by the author of Yolo v3
* prepare differents config files used by Yolo v3 to learn new objects ```def yolo_parameters```:
  - '''def yolo_cfg_file''': generate the config file for yolo v3 training
  - '''def yolo_names_file''': name(s) of the new object(s)
  - '''def yolo_data_file''': paths of all files needed for yolo v3 training
* set up the train et val dataset with ```def data_preprocessing```
* transform medical images (.dcm) into ".jpg" files with ```yolo_jpg_file``` and ```def dcm_to_array```
* generate label in the shape of yolo_v3 learning CNN with '''def yolo_label_generation```. This function indicate to the algorithm where is located the object in the image training or image validation
* generate a '.txt' file with the path and the name of each image '''def yolo_image_path_file```
* display pneumonia or not image with or without the box ```def visualisation```
* represent the loss trend line over the learning process ```def loss_function```


The folder **mrcnn** gather the heart of the Mask RCNN functioning. It comes from the great work of [Mask R-CNN library](https://github.com/matterport/Mask_RCNN) that Matterport built.

The files ```learning_ship.py``` and ```ship_detection.py``` are mostly from the work of [gabrielgarza](https://github.com/gabrielgarza/Mask_RCNN/tree/master/samples/ship)

Finally, the file ```data_preprocessing.py``` is the one I did in order to select few images in each Airbus *test* and *train* folders. Indeed, as I worked on a weak computer, I could not allow to train the model on the full data. Anyway, the aim was to understand the full process.


## Overview of Mask-RCNN pipeline

![Image of mrcnn](https://cdn-images-1.medium.com/max/2600/1*M_ZhHp8OXzWxEsfWu2e5EA.png)
