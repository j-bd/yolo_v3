# Implementation of Yolo v3

You will find here a test application of Yolo v3 deep learning method to an images detection challenge.


## Data source

I used data made available by "Radiological Society of North America" on Kaggle. The challenge name is ["RSNA Pneumonia Detection Challenge"](https://www.kaggle.com/c/rsna-pneumonia-detection-challenge).

The second version of data is organised as :
* A train folder with about 26 684 images,
* A test folder with about 3 000 images,
* A csv file named "stage_2_train_labels.csv" with the bounding boxes of all train images,
* A csv file named "sample_submission_v2.csv" to show the shape of the output expected.


## Global organization of the repository

The folder **data** gather few files automatically generated by my algorithms.

The file ```pneumonia_functions.py``` is mainly dedicated to prepare the algorithm to learn a new object. It offers the possibility to:
* create the structure of the project : ```def_structure``` and download automatically a pre trained weight given by the author of Yolo v3
* prepare different config files used by Yolo v3 to learn new objects ```def yolo_parameters```:
  - '''def yolo_cfg_file''': generate the config file for yolo v3 training
  - '''def yolo_names_file''': name(s) of the new object(s)
  - '''def yolo_data_file''': paths of all files needed for yolo v3 training
* set up the train et val dataset with ```def data_preprocessing```
* transform medical images (.dcm) into ".jpg" files with ```yolo_jpg_file``` and ```def dcm_to_array```
* generate label in the shape of yolo_v3 learning CNN with '''def yolo_label_generation```. This function indicate to the algorithm where is located the object in the image training or image validation
* generate a '.txt' file with the path and the name of each image '''def yolo_image_path_file```
* display pneumonia or not image with or without the box ```def visualisation```
* represent the loss trend line over the learning process ```def loss_function```

The file ```pneumonia_detection.py```is dedicated to the detection on the test images. It allows to:
* create a new '.cfg' file for yolo v3 detection as recommended by authors ```def test_cfg_file```
* launch detection on submitted image ```def detect```
* record all results under the right shape to be send to Kaggle

I offer the possibility to execute automatically all the algorithm trough ```main.py```



## Overview of Yolo v3

For more information about Yolo v3, you can download the [article](https://pjreddie.com/media/files/papers/YOLOv3.pdf) of Joseph Redmon and Ali Farhadi.

The biggest interest of this algorithm is the speed of process:
![Yolov3 inference time](https://pjreddie.com/media/image/map50blue.png)

You can find more information directly on the [website](https://pjreddie.com/darknet/yolo/)
